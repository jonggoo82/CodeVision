#include <mega128.h>
#include <delay.h>
#define S 2
#define COUNT 10

int comm[8] = {1,2,4,8,0x10,0x20,0x40,0x80};

int i,j=8,k=0,p=0;
int dot[9][8]={{0x18, 0x24, 0x42, 0x42, 0x7e, 0x42, 0x42, 0x42},
                     {0x3e, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08},
                     {0x00, 0x00, 0x00, 0x14, 0x2a, 0x2a, 0x2a, 0x2a},
                     {0x00, 0x00, 0x00, 0x18, 0x24, 0x3c, 0x20, 0x18},
                     {0x00, 0x00, 0x18, 0x24, 0x24, 0x1c, 0x04, 0x18},
                     {0x00, 0x00, 0x18, 0x04, 0x1c, 0x24, 0x24, 0x1a},
                     {0x08, 0x18, 0x28, 0x08, 0x08, 0x08, 0x08, 0x3c},
                     {0x3c, 0x42, 0x02, 0x04, 0x08, 0x10, 0x20, 0x7e},
                     {0x3c, 0x42, 0x42, 0x3c, 0x42, 0x42, 0x42, 0x3c}};

void main(void)
{
        DDRB = 0xff;                 // COMM 가로
        DDRC = 0xff;                 // GREEN 세로
        
        while(1)
        {
             for(p=0;p<9;p++)
             {
               for(j=0;j<8;j++)
               {
                 for(k=0; k< COUNT; k++)               // 시간지연
                 {
                  for(i=0;i<8;i++)
                  {
                           PORTB=comm[i];
                           PORTC = dot[p][i] << j | dot[p+1][i] >> (8-j);
                           delay_ms(S);       
                  }
                 }
               }
             }
        }
}
